{
    "componentChunkName": "component---src-templates-article-template-tsx",
    "path": "/garbage-collection/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>가비지 컬렉션(Garbage Collection)</h1>\n<h2>정의</h2>\n<p>할당된 메모리가 쓸모없어졌을 때 자동으로 해제시켜주는 방법</p>\n<h2>메모리 라이프 사이클</h2>\n<ol>\n<li>필요할 때 메모리 할당</li>\n<li>읽기/쓰기로 값 사용</li>\n<li>필요 없으면 해제</li>\n</ol>\n<h3>메모리 할당</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 기본형 값 할당</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token string\">'123'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 객체 할당</span>\n<span class=\"token keyword\">var</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  abc<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">func</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 함수 선언 할당(함수 객체)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 함수 호출하여 할당</span>\n<span class=\"token keyword\">var</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>값 사용</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ex 1)</span>\n<span class=\"token keyword\">var</span> num1 <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> num2 <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> num3 <span class=\"token operator\">=</span> num1 <span class=\"token operator\">+</span> num2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ex 2)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> total <span class=\"token operator\">=</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>메모리 해제</h3>\n<p>가비지 컬렉터(Garbage Collector)가 할당된 메모리를 계속 추적하고 사용하지 않는 메모리를 발견하면 회수한다. <code class=\"language-text\">사용하지 않는 메모리</code>를 판단하는 방법이 가비지 컬렉션의 핵심이다.</p>\n<h2>사용하지 않는 메모리 판별</h2>\n<p>가비지 컬렉션은 <code class=\"language-text\">참조(Reference)</code> 상태를 기준으로 메모리 해제 대상으로 지정(수집)하고 해제한다.</p>\n<h3>방식 1) Referennce-counting</h3>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Memory_Management#reference-counting_garbage_collection\" target=\"_blank\" rel=\"nofollow\">샘플 코드(MDN)</a></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// x = { a: { b: 2 } }</span>\n<span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  a<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    b<span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 'x'와 'y' 둘 다 '{ a: { b: 2 } }' 객체를 참조함</span>\n<span class=\"token keyword\">var</span> y <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// '{ a: { b: 2 } }' 객체는 y만 참조함</span>\n<span class=\"token comment\">// x는 가비지 컬렉션 대상 후보가 될 수 있음</span>\nx <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// z가 '{ a: { b: 2 } }'의 일부인 a 속성의 '{ b: 2 }' 객체를 참조함</span>\n<span class=\"token keyword\">var</span> z <span class=\"token operator\">=</span> y<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// y는 가비지 컬렉션 대상 후보가 될 수 있음</span>\ny <span class=\"token operator\">=</span> <span class=\"token string\">\"mozilla\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// '{ a: { b: 2 } }'를 참조하는 대상은 없어졌지만, z가 아직 '{ a: { b: 2 } }'의 일부인 a를 참조하고 있음</span>\n\n<span class=\"token comment\">// z는 가비지 컬렉션 대상 후보가 될 수 있음</span>\nz <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 그 어느 것도 '{ a: { b: 2 } }' 객체를 참조하지 않게 됨</span>\n<span class=\"token comment\">// x, y, z는 참고하고 있는 객체가 없으므로 현재 scope의 처리가 끝나면 가비지 컬렉터에 의해 메모리 해제 됨</span>\n</code></pre></div>\n<h4>문제점</h4>\n<p>아래와 같이 순환 참조가 된 상태의 경우, 수집 대상에 포함되지 않아 메모리 누수 발생</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">memoryLeak</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> ref1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> ref2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  ref1<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> ref2<span class=\"token punctuation\">;</span>\n  ref2<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> ref1<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">memoryLeak</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Internet Explorer 6, 7은 이 문제를 갖고 있음</p>\n<h3>방식 2) Mark-and-sweep</h3>\n<p>참조 연결이 <code class=\"language-text\">닿을 수 있는 객체들(Reachable Objects)</code>을 체크하고 체크되지 않은 대상은 가비지 컬렉션 대상으로 지정하여 해제한다.</p>\n<p><img src=\"https://plumbr.io/app/uploads/2015/05/Java-GC-mark-and-sweep.png\" alt=\"Java-GC-mark-and-sweep\"></p>\n<p>위 그림과 같이 최상위(전역) scrope에 있는 roots 라고 불리는 오브젝트 집합부터 시작해서 자식 오브젝트의 참조 끝까지 순회한다.\n순회가 끝나면 <code class=\"language-text\">닿지 않는 객체들(Non-Reachable Objects)</code>에 대해 메모리를 해제한다.\n가비지 컬렉션은 <code class=\"language-text\">런타임 환경</code>에서 실행되므로 웹 사이트의 성능에 영향을 덜 미치기 위하여 최적화가 적용되어 있다.</p>\n<h4>대표 최적화 기법 3가지</h4>\n<p><strong>Generational collection</strong></p>\n<p><code class=\"language-text\">새로운 객체</code>, <code class=\"language-text\">오래된 객체</code>로 분류한다. 즉시 사용되고 사라질 가능성이 있는 최근에 생성된 <code class=\"language-text\">새로운 객체</code> 위주로 우선 감시하고, 계속 사용되고 있는 <code class=\"language-text\">오래된 객체</code>는 상대적으로 덜 감시한다.</p>\n<p><strong>incremental collection</strong></p>\n<p>참조 관계의 개수가 많아지면 체크(Mark)하는 데에 시간이 오래 걸리므로 가비지 컬렉션을 여러 개로 분리하여 각자 별도로 수행한다. 분리, 변경사항 추적에 추가 작업이 필요하지만, 짧은 간격으로 실행할 수 있는 장점이 있다.</p>\n<p><strong>idle-time collection</strong></p>\n<p>가비지 컬렉터는 CPU가 유휴 상태일 때에만 가비지 컬렉션을 실행한다.</p>\n<h2>메모리 누수</h2>\n<p>잘 정리된 글이 있어서 대체</p>\n<ul>\n<li><a href=\"https://engineering.huiseoul.com/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8A%94%EA%B0%80-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EA%B4%80%EB%A6%AC-4%EA%B0%80%EC%A7%80-%ED%9D%94%ED%95%9C-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%88%84%EC%88%98-%EB%8C%80%EC%B2%98%EB%B2%95-5b0d217d788d\" target=\"_blank\" rel=\"nofollow\">자바스크립트는 어떻게 작동하는가: 메모리 관리 + 4가지 흔한 메모리 누수 대처법</a></li>\n<li><a href=\"https://yceffort.kr/2020/07/memory-leaks-in-javascript#introduction\" target=\"_blank\" rel=\"nofollow\">자바스크립트 메모리 누수와 해결 방법</a></li>\n<li><a href=\"https://ui.toast.com/weekly-pick/ko_20210611\" target=\"_blank\" rel=\"nofollow\">당신이 모르는 자바스크립트의 메모리 누수의 비밀</a></li>\n</ul>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Memory_Management\" target=\"_blank\" rel=\"nofollow\">자바스크립트의 메모리관리 - JavaScript | MDN (mozilla.org)</a></li>\n<li><a href=\"https://ko.javascript.info/garbage-collection\" target=\"_blank\" rel=\"nofollow\">가비지 컬렉션 (javascript.info)</a></li>\n<li><a href=\"https://plumbr.io/handbook/garbage-collection-algorithms\" target=\"_blank\" rel=\"nofollow\">GC Algorithms: Basics | Plumbr – User Experience &#x26; Application Performance Monitoring</a></li>\n</ul>","frontmatter":{"title":"가비지 컬렉션(Garbage Collection)","summary":"JavaScript의 가비지 컬렉션에 대해서 알아본다.","date":"2021.09.01","categories":["JavaScript"],"featuredImgUrl":"https://images.pexels.com/photos/4684372/pexels-photo-4684372.jpeg","featuredImgAlt":"Garbage Collection in JavaScript"}}}],"nodes":[{"featuredImg":{"publicURL":"/WIL/static/b158a10dbb00ac8c15b3758012a02302/pexels-photo-4684372.jpeg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAYHCP/EABQBAQAAAAAAAAAAAAAAAAAAAAT/2gAMAwEAAhADEAAAAaIo6+SCMyUVMEj/xAAZEAEAAwEBAAAAAAAAAAAAAAAEAgUGAwH/2gAIAQEAAQUCq8dMeSjTiz9PW56SedqIcMw7xUnqAKXb/8QAIREAAgEEAgIDAAAAAAAAAAAAAQIDBBITIQARIjEycbH/2gAIAQMBAT8BhmiqJQbpTVqJhmks6XCyiQFFTpxZJb7B+RBfXHrFV2XNJ4m3dNGTrXvOPwfXP//EACARAAICAwABBQAAAAAAAAAAAAEDAgQSEyIAERQhYYH/2gAIAQIBAT8BsRbWpbtKPZNlU1qTJuchdA0TEmMGEpMiJdAgesRILGWKKjZpWw1K/cRPm84Drr4Bpkj9JP2fP//EACMQAAICAgEEAgMAAAAAAAAAAAIDAQQFERIAEyEiBkEUMVH/2gAIAQEABj8Cr43K5Za7QqzN0DMGIxizKqKKtMJaZxUQ1ncFQSwWEUk3hMl1npoXM3lbKLAV11sNVS2++i6wlk2z7wKSZxNi1LRUwYBSVvGWARTFi2vNfKlTatve0by6YWu6fHlLvRkGc6jbBLRT+v7P5MVUG5TwgWOWLThpC0e/BTr3CZklcuXbIpmJ3O+rrTv2TMl1ykpmOUnKhGWFvYkUiAj5HjwiB199ERJI5Lz7NLx9ajxERHjeojW5nr//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPyEoY+Sk0LUp8UbMJHWdenMes/CaJlcHl5I9TBElNQgYjuZokxYSrr/ggHi8Tnsagji8CBUgRAb/2gAMAwEAAgADAAAAENcf/8QAGBEBAQEBAQAAAAAAAAAAAAAAASERMVH/2gAIAQMBAT8QYSLUzTZduKoKZDdCCaAMGgeCD//EABgRAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAECAQE/EHKocw4lTTYkxcvouHj+FDXNBqVf/8QAGBABAQEBAQAAAAAAAAAAAAAAAREAIRD/2gAIAQEAAT8QcQKh5qwQGR3zo8jaPe9TsWJKklKLIKBjB4Rb6vwXtvW+Z5OiL921nk+CoxiT0JR7GuUQG//Z"},"images":{"fallback":{"src":"/WIL/static/b158a10dbb00ac8c15b3758012a02302/1ce0c/pexels-photo-4684372.jpg","srcSet":"/WIL/static/b158a10dbb00ac8c15b3758012a02302/749c2/pexels-photo-4684372.jpg 1443w,\n/WIL/static/b158a10dbb00ac8c15b3758012a02302/c888d/pexels-photo-4684372.jpg 2886w,\n/WIL/static/b158a10dbb00ac8c15b3758012a02302/1ce0c/pexels-photo-4684372.jpg 5771w","sizes":"(min-width: 5771px) 5771px, 100vw"},"sources":[{"srcSet":"/WIL/static/b158a10dbb00ac8c15b3758012a02302/0a61f/pexels-photo-4684372.webp 1443w,\n/WIL/static/b158a10dbb00ac8c15b3758012a02302/68048/pexels-photo-4684372.webp 2886w,\n/WIL/static/b158a10dbb00ac8c15b3758012a02302/1f31a/pexels-photo-4684372.webp 5771w","type":"image/webp","sizes":"(min-width: 5771px) 5771px, 100vw"}]},"width":5771,"height":3847}}}}]}},"pageContext":{"slug":"/garbage-collection/"}},
    "staticQueryHashes": []}